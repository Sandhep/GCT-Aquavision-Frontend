{"ast":null,"code":"import*as React from'react';import dayjs from'dayjs';import Stack from'@mui/material/Stack';import Typography from'@mui/material/Typography';import{AdapterDayjs}from'@mui/x-date-pickers/AdapterDayjs';import{LocalizationProvider}from'@mui/x-date-pickers/LocalizationProvider';import{TimePicker}from'@mui/x-date-pickers/TimePicker';import{Button,FormControl,TextField}from'@mui/material';import{settime}from'../features/time';import{settimer}from'../features/timerswitch';import{useDispatch,useSelector}from'react-redux';import io from\"socket.io-client\";import FormControlLabel from'@mui/material/FormControlLabel';import Switch from'@mui/material/Switch';import{useEffect,useState}from'react';import{set_timerbutton}from'../features/timerbutton';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io.connect(process.env.REACT_APP_SERVER_URL);export default function Timer(){const dispatch=useDispatch();const timedata=useSelector(state=>state.time.value);const timerdata=useSelector(state=>state.timer.value);const timerbutton=useSelector(state=>state.timerbutton.value);const[startTemp,setStartTemp]=useState(timedata.starttime?dayjs(timedata.starttime,'HH:mm'):null);const[endTemp,setEndTemp]=useState(timedata.endtime?dayjs(timedata.endtime,'HH:mm'):null);useEffect(()=>{const handletimer=data=>{dispatch(settimer({mode:data.Timer===\"ENABLED\"?true:false,modestate:data.Timer}));};const handletimerdata=data=>{let startTemp=data.starttime?dayjs(data.starttime,'HH:mm'):null;let endTemp=data.endtime?dayjs(data.endtime,'HH:mm'):null;let bt_state=data.bt_state;dispatch(settime({starttime:startTemp?startTemp.format('HH:mm'):null,endtime:endTemp?endTemp.format('HH:mm'):null}));dispatch(set_timerbutton({bt_state}));setStartTemp(startTemp);setEndTemp(endTemp);};socket.on(\"connected\",handletimer);socket.on(\"connected\",handletimerdata);socket.on(\"Received_Timermode\",handletimer);socket.on(\"Received_Timerdata\",handletimerdata);return()=>{socket.off(\"connected\",handletimer);socket.off(\"connected\",handletimerdata);};},[dispatch]);const handleSetTime=()=>{if(!startTemp||!endTemp){alert('Time field is Empty');return;}dispatch(settime({starttime:startTemp?startTemp.format('HH:mm'):null,endtime:endTemp?endTemp.format('HH:mm'):null}));dispatch(set_timerbutton({bt_state:\"SAVED\"}));socket.emit(\"Timerdata\",{starttime:startTemp.format('HH:mm'),endtime:endTemp.format('HH:mm'),bt_state:\"SAVED\"});};const handleStartChange=newValue=>{setStartTemp(newValue);dispatch(set_timerbutton({bt_state:\"SET TIME\"}));};const handleEndChange=newValue=>{setEndTemp(newValue);dispatch(set_timerbutton({bt_state:\"SET TIME\"}));};const handleChange=event=>{const isChecked=event.target.checked;const state=isChecked?\"ENABLED\":\"DISABLED\";dispatch(settimer({mode:isChecked,modestate:state}));socket.emit(\"Timermode\",{Timer:state});};return/*#__PURE__*/_jsxs(LocalizationProvider,{dateAdapter:AdapterDayjs,children:[/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{checked:timerdata.mode,onChange:handleChange}),label:timerdata.modestate}),/*#__PURE__*/_jsxs(Stack,{spacing:2,sx:{minWidth:305,width:'100%'},children:[/*#__PURE__*/_jsxs(FormControl,{sx:{width:'100%'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:\"Start Time\"}),/*#__PURE__*/_jsx(TimePicker,{value:startTemp,onChange:handleStartChange,referenceDate:dayjs('2022-04-17'),disabled:!timerdata.mode,renderInput:params=>/*#__PURE__*/_jsx(TextField,{...params,fullWidth:true})})]}),/*#__PURE__*/_jsxs(FormControl,{sx:{width:'100%'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:\"Stop Time\"}),/*#__PURE__*/_jsx(TimePicker,{value:endTemp,onChange:handleEndChange,referenceDate:dayjs('2022-04-17'),disabled:!timerdata.mode,renderInput:params=>/*#__PURE__*/_jsx(TextField,{...params,fullWidth:true})})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSetTime,disabled:!timerdata.mode,sx:{alignSelf:'flex-start'},children:timerbutton.bt_state})]})]});}","map":{"version":3,"names":["React","dayjs","Stack","Typography","AdapterDayjs","LocalizationProvider","TimePicker","Button","FormControl","TextField","settime","settimer","useDispatch","useSelector","io","FormControlLabel","Switch","useEffect","useState","set_timerbutton","jsx","_jsx","jsxs","_jsxs","socket","connect","process","env","REACT_APP_SERVER_URL","Timer","dispatch","timedata","state","time","value","timerdata","timer","timerbutton","startTemp","setStartTemp","starttime","endTemp","setEndTemp","endtime","handletimer","data","mode","modestate","handletimerdata","bt_state","format","on","off","handleSetTime","alert","emit","handleStartChange","newValue","handleEndChange","handleChange","event","isChecked","target","checked","dateAdapter","children","control","onChange","label","spacing","sx","minWidth","width","variant","referenceDate","disabled","renderInput","params","fullWidth","onClick","alignSelf"],"sources":["C:/Projects/React Projects/Dashboard/dashboard/src/components/Timer.js"],"sourcesContent":["import * as React from 'react';\r\nimport dayjs from 'dayjs';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\nimport { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs';\r\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\r\nimport { TimePicker } from '@mui/x-date-pickers/TimePicker';\r\nimport { Button, FormControl, TextField } from '@mui/material';\r\nimport { settime } from '../features/time';\r\nimport { settimer } from '../features/timerswitch';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport io from \"socket.io-client\";\r\nimport FormControlLabel from '@mui/material/FormControlLabel';\r\nimport Switch from '@mui/material/Switch';\r\nimport { useEffect, useState } from 'react';\r\nimport { set_timerbutton } from '../features/timerbutton';\r\n\r\nconst socket = io.connect(process.env.REACT_APP_SERVER_URL);\r\n\r\nexport default function Timer() {\r\n  const dispatch = useDispatch();\r\n  const timedata = useSelector(state => state.time.value);\r\n  const timerdata = useSelector(state => state.timer.value);\r\n  const timerbutton = useSelector(state => state.timerbutton.value);\r\n\r\n  const [startTemp, setStartTemp] = useState(timedata.starttime ? dayjs(timedata.starttime, 'HH:mm') : null);\r\n  const [endTemp, setEndTemp] = useState(timedata.endtime ? dayjs(timedata.endtime, 'HH:mm') : null);\r\n\r\n  useEffect(() => {\r\n    const handletimer = (data) => {\r\n      dispatch(settimer({\r\n        mode: data.Timer === \"ENABLED\" ? true : false,\r\n        modestate: data.Timer\r\n      }));\r\n    };\r\n\r\n    const handletimerdata = (data) => {\r\n      let startTemp = data.starttime ? dayjs(data.starttime, 'HH:mm') : null;\r\n      let endTemp = data.endtime ? dayjs(data.endtime, 'HH:mm') : null;\r\n      let bt_state = data.bt_state;\r\n      dispatch(settime({\r\n        starttime: startTemp ? startTemp.format('HH:mm') : null,\r\n        endtime: endTemp ? endTemp.format('HH:mm') : null,\r\n      }));\r\n      dispatch(set_timerbutton({ bt_state }));\r\n\r\n      setStartTemp(startTemp);\r\n      setEndTemp(endTemp);\r\n    }\r\n\r\n    socket.on(\"connected\", handletimer);\r\n    socket.on(\"connected\", handletimerdata);\r\n    socket.on(\"Received_Timermode\", handletimer);\r\n    socket.on(\"Received_Timerdata\", handletimerdata);\r\n\r\n    return () => {\r\n      socket.off(\"connected\", handletimer);\r\n      socket.off(\"connected\", handletimerdata);\r\n    }\r\n  }, [dispatch]);\r\n\r\n  const handleSetTime = () => {\r\n    if (!startTemp || !endTemp) {\r\n      alert('Time field is Empty');\r\n      return;\r\n    }\r\n\r\n    dispatch(settime({\r\n      starttime: startTemp ? startTemp.format('HH:mm') : null,\r\n      endtime: endTemp ? endTemp.format('HH:mm') : null\r\n    }));\r\n\r\n    dispatch(set_timerbutton({\r\n      bt_state: \"SAVED\"\r\n    }));\r\n\r\n    socket.emit(\"Timerdata\", {\r\n      starttime: startTemp.format('HH:mm'),\r\n      endtime: endTemp.format('HH:mm'),\r\n      bt_state: \"SAVED\",\r\n    });\r\n  };\r\n\r\n  const handleStartChange = (newValue) => {\r\n    setStartTemp(newValue);\r\n    dispatch(set_timerbutton({\r\n      bt_state: \"SET TIME\"\r\n    }));\r\n  };\r\n\r\n  const handleEndChange = (newValue) => {\r\n    setEndTemp(newValue);\r\n    dispatch(set_timerbutton({\r\n      bt_state: \"SET TIME\"\r\n    }));\r\n  };\r\n\r\n  const handleChange = (event) => {\r\n    const isChecked = event.target.checked;\r\n    const state = isChecked ? \"ENABLED\" : \"DISABLED\";\r\n    dispatch(settimer({\r\n      mode: isChecked,\r\n      modestate: state\r\n    }));\r\n\r\n    socket.emit(\"Timermode\", { Timer: state });\r\n  }\r\n\r\n  return (\r\n    <LocalizationProvider dateAdapter={AdapterDayjs}>\r\n      <FormControlLabel\r\n        control={\r\n          <Switch\r\n            checked={timerdata.mode}\r\n            onChange={handleChange}\r\n          />\r\n        }\r\n        label={timerdata.modestate}\r\n      />\r\n      <Stack spacing={2} sx={{ minWidth: 305, width: '100%' }}>\r\n        <FormControl sx={{ width: '100%' }}>\r\n          <Typography variant=\"subtitle1\">Start Time</Typography>\r\n          <TimePicker\r\n            value={startTemp}\r\n            onChange={handleStartChange}\r\n            referenceDate={dayjs('2022-04-17')}\r\n            disabled={!timerdata.mode}\r\n            renderInput={(params) => <TextField {...params} fullWidth />}\r\n          />\r\n        </FormControl>\r\n        <FormControl sx={{ width: '100%' }}>\r\n          <Typography variant=\"subtitle1\">Stop Time</Typography>\r\n          <TimePicker\r\n            value={endTemp}\r\n            onChange={handleEndChange}\r\n            referenceDate={dayjs('2022-04-17')}\r\n            disabled={!timerdata.mode}\r\n            renderInput={(params) => <TextField {...params} fullWidth />}\r\n          />\r\n        </FormControl>\r\n        <Button\r\n          variant=\"contained\"\r\n          onClick={handleSetTime}\r\n          disabled={!timerdata.mode}\r\n          sx={{ \r\n            alignSelf: 'flex-start'\r\n           }}\r\n        >\r\n          {timerbutton.bt_state}\r\n        </Button>\r\n      </Stack>\r\n    </LocalizationProvider>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}